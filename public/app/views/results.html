<div class="row">
    <section class="col-md-8 affix">

        <div class="input-group">
            <div class="input-group-btn">
                <button ng-disabled="search.$invalid" ng-click="$searchService.submitSearch($searchService.searchTerms)" type="button"
                        class="btn btn-default">Search <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                </button>
                <!--<button type="button" class="btn btn-default" uib-popover-template="results_filter.templateUrl" popover-placement="bottom">-->
                    <!--<span class="caret"></span>-->
                <!--</button>-->
            </div>
            <input type="text" ng-model="$searchService.searchTerms" name="q" required class="form-control" autofocus ng-enter="$searchService.submitSearch($searchService.searchTerms);" placeholder="Search for...">
        </div>

        <script type="text/ng-template" id="results_filter.html">
            <div class="row">
                <div class="col-md-12">
                    <div class="btn-group-vertical">
                        <h5>Technologies</h5>
                        <label ng-repeat="category in results_filter.categories" ng-model="results_filter.categories[$index].active" ng-class="{ disabled: category.count <= 0 }" class="btn btn-default btn-sm" uib-btn-checkbox>
                            {{category.displayValue}} <span class="badge">{{category.count}}</span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="btn-group-vertical">
                        <h5>Tags</h5>
                        <label ng-repeat="tag in results_filter.tags" ng-model="results_filter.tags[$index].active" ng-class="{ disabled: tag.count <= 0 }" class="btn btn-default btn-sm" uib-btn-checkbox>
                            {{tag.displayValue}} <span class="badge">{{tag.count}}</span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="btn-group-vertical">
                        <h5>Ratings</h5>
                        <label ng-repeat="rating in results_filter.ratings" ng-model="results_filter.ratings[$index].active" ng-class="{ disabled: rating.count <= 0 }" class="btn btn-default btn-sm" uib-btn-checkbox>
                            {{rating.displayValue}} <span class="badge">{{rating.count}}</span>
                        </label>
                    </div>
                </div>
            </div>
        </script>
    </section>
</div>
<br/><br/><br/>
<div class="row">
    <section class="col-md-8">
        <span ng-show="!($searchService.searchResults.inProgress)">{{$searchService.searchResults.total_count}} result(s) found</span>
        <span ng-show="$searchService.searchResults.inProgress">Searching...&nbsp;&nbsp;&nbsp;<img src="images/spinner.gif" height="20px" width="20px"/></span>
    </section>
    <!--<section class="col-md-4">-->
        <!--<span class="h4">Sort By: </span>-->
        <!--<div class="btn-group">-->
            <!--<label ng-model="results_sort" class="btn btn-default" uib-btn-radio="'date'" uncheckable>Date</label>-->
            <!--<label ng-model="results_sort" class="btn btn-default" uib-btn-radio="'rating'" uncheckable>Rating</label>-->
            <!--<label ng-model="results_sort" class="btn btn-default" uib-btn-radio="'views'" uncheckable># Views</label>-->
        <!--</div>-->
    <!--</section>-->
</div>
<hr/>
<div class="row">
    <section class="col-md-12">
        <!--
<div ng-repeat>
    <link>Repository Name</link><expand-graphic/>
    <div>Repository Description</div>
    <div ng-repeat>
        <link>Matched FileName</link><expand-graphic/>
        <div ng-repeat>
            <div>Matched Fragments</div>
        </div>
    </div>
</div>
-->
        <div data-ng-repeat="item in $searchService.searchResults.items.slice((($searchService.pagination.currentPage-1)*$searchService.pagination.itemsPerPage), (($searchService.pagination.currentPage)*$searchService.pagination.itemsPerPage))"
             show-more-directive>
            <h2><a ui-sref="search.results.overview({ snippetId: '{{item.repository.name}}'})">{{item.repository.displayName}}</a></h2>

            <div class="row">
                <div class="col-md-9">
                    <div data-ng-repeat="text_match in item.text_matches.slice((($searchService.pagination.currentPage-1)*$searchService.pagination.itemsPerPage), (($searchService.pagination.currentPage)*$searchService.pagination.itemsPerPage))"
                         show-more-directive>
                        <div class="row">
                            <div class="col-md-12">
                                <article>
                                    <div data-ng-repeat="match in text_match.matches">
                                        <div ng-bind-html="$searchService.trustHtmlSnippet(match.highlit_fragment)"></div>
                                    </div>
                                </article>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <article>
                        <!--<uib-rating ng-model="item.score" max="max" readonly="isReadonly"-->
                                    <!--on-hover="hoveringOver(value)" on-leave="overStar = null"-->
                                    <!--titles="['one','two','three']"></uib-rating>-->
                <span class="label"
                      ng-class="{'label-warning': percent<30, 'label-info': percent>=30 && percent<70, 'label-success': percent>=70}"
                      ng-show="overStar && !isReadonly">{{percent}}%</span>
                        <div>Score: {{item.score}}</div>
                        <!--<div>Last updated (last commit date)</div>-->
                        <!--<div>nnnn views (track in Mongo)</div>-->
                        <div>Posted on (initial commit date)</div>
                        <div>Posted by (track in Mongo)</div>
                        <br/><br/><br/>
                    </article>
                </div>
            </div>
        </div>
    </section>
</div>
<div class="row">
    <section class="col-md-12">
        <span ng-repeat="criteria in search_criteria">
            <label ng-model="search_criteria[$index].active" ng-class="{ disabled: criteria.count <= 0 }" class="btn btn-default btn-sm" uib-btn-checkbox>
                {{criteria.displayValue}} <span class="badge">{{criteria.count}}</span>
            </label>
        </span>
    </section>
</div>
<br/><br/><br/><br/>
<div class="row">
    <section class="col-md-12">
        <nav class="text-center">
            <div>
                <uib-pagination total-items="$searchService.pagination.totalItems" ng-model="$searchService.pagination.currentPage" ng-change="$searchService.pagination.pageChanged()" max-size="$searchService.pagination.maxSize" class="pagination-sm" boundary-links="true" rotate="false" num-pages="$searchService.pagination.numPages" items-per-page="$searchService.pagination.itemsPerPage" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"></uib-pagination>
            </div>
            <div>
                View <select ng-model="$searchService.pagination.viewby" ng-change="$searchService.pagination.setItemsPerPage($searchService.pagination.viewby)">
                <option>1</option>
                <option>5</option>
                <option>10</option>
                <option>20</option>
                <option>30</option>
                <option>40</option>
                <option>50</option>
            </select> records at a time.
            </div>
        </nav>
    </section>
</div>
<br/>